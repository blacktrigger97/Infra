networks:
  bdCluster:
    name: bdCluster
    driver: ipvlan
    external: true
    driver_opts:
      parent: ${ETHERNET_NAME}
    ipam:
      config:
        - subnet: 192.168.1.0/24
          ip_range: 192.168.1.0/24
          gateway: 192.168.1.1

services:

  nessie:
    image: ghcr.io/projectnessie/nessie:${NESSIE_VER}
    container_name: nessie
    hostname: nessie.bdc.home
    restart: unless-stopped
    networks:
      bdCluster:
        ipv4_address: 192.168.1.31
    ports:
      - 19120:19120
    environment:
      - quarkus.datasource.db-kind=postgresql
      - quarkus.datasource.jdbc.max-size=16
      - quarkus.datasource.username=${DOCKER_USR}
      - quarkus.datasource.password=${DOCKER_PASS}
      - quarkus.debug.print-startup-times=true
      - quarkus.profile=prod
      - quarkus.datasource.driver='org.postgresql.Driver'
      - quarkus.http.port=19120
      - quarkus.http.host=nessie.bdc.home
      - quarkus.datasource.jdbc.url=jdbc:postgresql://postgresql.bdc.home:5432/nessie
      - quarkus.oidc.enabled="false"
      - nessie.version.store.type=JDBC
      - nessie.catalog.default-warehouse=warehouse
      - nessie.catalog.warehouses.warehouse.location=s3a://warehouse/nessie
      - nessie.catalog.service.s3.default-options.request-signing-enabled=false
      - nessie.catalog.service.s3.default-options.endpoint=${MINIO_ENDPOINT}
      - nessie.catalog.service.s3.default-options.path-style-access=true
      - nessie.catalog.service.s3.default-options.region=us-east-1
      - nessie.catalog.service.s3.default-options.access-key=urn:nessie-secret:quarkus:nessie.catalog.secrets.access-key
      - nessie.catalog.secrets.access-key.name=admin
      - nessie.catalog.secrets.access-key.secret=password
      - nessie.server.authentication.enabled=false

  hue-minio:
    image: gethue/hue:latest
    hostname: hue.bdc.home
    container_name: hue
    restart: unless-stopped
    networks:
      bdCluster:
        ipv4_address: 192.168.1.32
    ports:
      - 8888:8888
    volumes:
      - ./hue/hue_minio.ini:/usr/share/hue/desktop/conf/z-hue.ini
      - ./hue/core-site.xml:/usr/share/hue/desktop/conf/core-site.xml:z

  hue-hdfs:
    image: gethue/hue:latest
    hostname: hue.bdc.home
    container_name: hue
    restart: unless-stopped
    networks:
      bdCluster:
        ipv4_address: 192.168.1.32
    ports:
      - 8888:8888
    volumes:
      - ./hue/hue_hdfs.ini:/usr/share/hue/desktop/conf/z-hue.ini

  marimo:
    build: 
      context: marimo
      dockerfile: ${HOST_DIR}/ext_serv/marimo/Dockerfile
    container_name: marimo
    hostname: marimo.bdc.home
    user: root
    networks:
      bdCluster:
        ipv4_address: 192.168.1.47
    ports:
      - 8091:8091
    restart: unless-stopped
    environment:
      - TZ=Asia/Kolkata
    volumes:
      - /root/notebooks:/root/notebooks

  
  

  
  

  